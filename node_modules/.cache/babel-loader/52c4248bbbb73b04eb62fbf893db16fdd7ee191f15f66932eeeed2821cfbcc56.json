{"ast":null,"code":"var _jsxFileName = \"/Users/bmorety/Documents/bubble/src/App.tsx\",\n  _s = $RefreshSig$();\nimport \"./App.css\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Component() {\n  _s();\n  const [stationData, setStationData] = useState(null);\n  const [departureData, setDepartureData] = useState(null);\n  const [error, setError] = useState(null);\n  const [showDepartures, setShowDepartures] = useState(false);\n  const canvasRef = useRef(null);\n  async function queryMvg(lat, lon) {\n    try {\n      const response = await fetch(`https://www.mvg.de/api/fib/v2/station/nearby?latitude=${lat}&longitude=${lon}`);\n      if (!response.ok) throw new Error(\"Failed to fetch data from MVG API\");\n      const data = await response.json();\n      setStationData(data[0]);\n      const stationId = data[0].globalId;\n      const departureResponse = await fetch(`https://www.mvg.de/api/fib/v2/departure?globalId=${stationId}&limit=10&offsetInMinutes=0`);\n      if (!departureResponse.ok) throw new Error(\"Failed to fetch departure data from MVG API\");\n      const departureData = await departureResponse.json();\n      setDepartureData(departureData);\n    } catch (error) {\n      setError(error.message);\n    }\n  }\n  useEffect(() => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(async position => {\n        const {\n          latitude,\n          longitude\n        } = position.coords;\n        await queryMvg(latitude, longitude);\n      }, error => {\n        setError(getGeolocationErrorMessage(error));\n      });\n    } else {\n      setError(\"Geolocation not supported\");\n    }\n  }, []);\n  useEffect(() => {\n    if (stationData && canvasRef.current) {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      drawStationBubble(ctx, canvas.width / 2, canvas.height / 2, stationData);\n    }\n  }, [stationData]);\n  function drawStationBubble(ctx, x, y, station) {\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    ctx.beginPath();\n    ctx.arc(x, y, 100, 0, 2 * Math.PI);\n    ctx.fillStyle = 'rgba(0, 123, 255, 0.7)';\n    ctx.fill();\n    ctx.strokeStyle = 'white';\n    ctx.lineWidth = 2;\n    ctx.stroke();\n    ctx.fillStyle = 'white';\n    ctx.font = '16px Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText(station.name, x, y - 20);\n    ctx.font = '14px Arial';\n    station.transportTypes.forEach((type, index) => {\n      ctx.fillText(type, x, y + 10 + index * 20);\n    });\n  }\n  function handleCanvasClick() {\n    setShowDepartures(!showDepartures);\n  }\n  function getGeolocationErrorMessage(error) {\n    switch (error.code) {\n      case error.PERMISSION_DENIED:\n        return \"User denied the request for Geolocation.\";\n      case error.POSITION_UNAVAILABLE:\n        return \"Location information is unavailable.\";\n      case error.TIMEOUT:\n        return \"The request to get user location timed out.\";\n      default:\n        return \"An unknown error occurred.\";\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 p-4\",\n    children: [error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-red-500 mb-4\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }, this), stationData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: 300,\n        height: 300,\n        onClick: handleCanvasClick,\n        className: \"mx-auto cursor-pointer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this), showDepartures && departureData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-md p-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold mb-4\",\n        children: \"Departure Information\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this), departureData.map((departure, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4 p-2 border-b last:border-b-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: `font-semibold ${departure.cancelled ? 'text-red-500' : ''}`,\n          children: [departure.transportType, \" \", departure.label, \" to \", departure.destination]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Planned: \", new Date(departure.plannedDepartureTime).toLocaleTimeString()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Realtime: \", new Date(departure.realtimeDepartureTime).toLocaleTimeString()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 15\n        }, this), departure.delayInMinutes > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-orange-500\",\n          children: [\"Delay: \", departure.delayInMinutes, \" min\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Occupancy: \", departure.occupancy]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 15\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n}\n_s(Component, \"yda++DS9wHO1qKjoTdLa/Rk6nnQ=\");\n_c = Component;\nvar _c;\n$RefreshReg$(_c, \"Component\");","map":{"version":3,"names":["useState","useEffect","useRef","jsxDEV","_jsxDEV","Component","_s","stationData","setStationData","departureData","setDepartureData","error","setError","showDepartures","setShowDepartures","canvasRef","queryMvg","lat","lon","response","fetch","ok","Error","data","json","stationId","globalId","departureResponse","message","navigator","geolocation","getCurrentPosition","position","latitude","longitude","coords","getGeolocationErrorMessage","current","canvas","ctx","getContext","drawStationBubble","width","height","x","y","station","clearRect","beginPath","arc","Math","PI","fillStyle","fill","strokeStyle","lineWidth","stroke","font","textAlign","fillText","name","transportTypes","forEach","type","index","handleCanvasClick","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","onClick","map","departure","cancelled","transportType","label","destination","Date","plannedDepartureTime","toLocaleTimeString","realtimeDepartureTime","delayInMinutes","occupancy","_c","$RefreshReg$"],"sources":["/Users/bmorety/Documents/bubble/src/App.tsx"],"sourcesContent":["import \"./App.css\";\nimport { useState, useEffect, useRef } from \"react\";\n\nexport default function Component() {\n  const [stationData, setStationData] = useState(null);\n  const [departureData, setDepartureData] = useState(null);\n  const [error, setError] = useState(null);\n  const [showDepartures, setShowDepartures] = useState(false);\n  const canvasRef = useRef(null);\n\n  async function queryMvg(lat, lon) {\n    try {\n      const response = await fetch(\n        `https://www.mvg.de/api/fib/v2/station/nearby?latitude=${lat}&longitude=${lon}`\n      );\n      if (!response.ok) throw new Error(\"Failed to fetch data from MVG API\");\n      const data = await response.json();\n      setStationData(data[0]);\n\n      const stationId = data[0].globalId;\n      const departureResponse = await fetch(\n        `https://www.mvg.de/api/fib/v2/departure?globalId=${stationId}&limit=10&offsetInMinutes=0`\n      );\n      if (!departureResponse.ok) throw new Error(\"Failed to fetch departure data from MVG API\");\n      const departureData = await departureResponse.json();\n      setDepartureData(departureData);\n    } catch (error) {\n      setError(error.message);\n    }\n  }\n\n  useEffect(() => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(\n        async (position) => {\n          const { latitude, longitude } = position.coords;\n          await queryMvg(latitude, longitude);\n        },\n        (error) => {\n          setError(getGeolocationErrorMessage(error));\n        }\n      );\n    } else {\n      setError(\"Geolocation not supported\");\n    }\n  }, []);\n\n  useEffect(() => {\n    if (stationData && canvasRef.current) {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      drawStationBubble(ctx, canvas.width / 2, canvas.height / 2, stationData);\n    }\n  }, [stationData]);\n\n  function drawStationBubble(ctx, x, y, station) {\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    ctx.beginPath();\n    ctx.arc(x, y, 100, 0, 2 * Math.PI);\n    ctx.fillStyle = 'rgba(0, 123, 255, 0.7)';\n    ctx.fill();\n    ctx.strokeStyle = 'white';\n    ctx.lineWidth = 2;\n    ctx.stroke();\n\n    ctx.fillStyle = 'white';\n    ctx.font = '16px Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText(station.name, x, y - 20);\n\n    ctx.font = '14px Arial';\n    station.transportTypes.forEach((type, index) => {\n      ctx.fillText(type, x, y + 10 + index * 20);\n    });\n  }\n\n  function handleCanvasClick() {\n    setShowDepartures(!showDepartures);\n  }\n\n  function getGeolocationErrorMessage(error) {\n    switch (error.code) {\n      case error.PERMISSION_DENIED:\n        return \"User denied the request for Geolocation.\";\n      case error.POSITION_UNAVAILABLE:\n        return \"Location information is unavailable.\";\n      case error.TIMEOUT:\n        return \"The request to get user location timed out.\";\n      default:\n        return \"An unknown error occurred.\";\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 p-4\">\n      {error && <p className=\"text-red-500 mb-4\">{error}</p>}\n      {stationData && (\n        <div className=\"mb-4\">\n          <canvas\n            ref={canvasRef}\n            width={300}\n            height={300}\n            onClick={handleCanvasClick}\n            className=\"mx-auto cursor-pointer\"\n          />\n        </div>\n      )}\n      {showDepartures && departureData && (\n        <div className=\"bg-white rounded-lg shadow-md p-4\">\n          <h2 className=\"text-2xl font-bold mb-4\">Departure Information</h2>\n          {departureData.map((departure, index) => (\n            <div key={index} className=\"mb-4 p-2 border-b last:border-b-0\">\n              <p className={`font-semibold ${departure.cancelled ? 'text-red-500' : ''}`}>\n                {departure.transportType} {departure.label} to {departure.destination}\n              </p>\n              <p>Planned: {new Date(departure.plannedDepartureTime).toLocaleTimeString()}</p>\n              <p>Realtime: {new Date(departure.realtimeDepartureTime).toLocaleTimeString()}</p>\n              {departure.delayInMinutes > 0 && (\n                <p className=\"text-orange-500\">Delay: {departure.delayInMinutes} min</p>\n              )}\n              <p>Occupancy: {departure.occupancy}</p>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}